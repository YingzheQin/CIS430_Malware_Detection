import os
import numpy as np
import cv2


def read_bytes(file_path, num_bytes=1024):
    """ Read a specified number of bytes from a file. """
    with open(file_path, 'rb') as f:
        return f.read(num_bytes)


def bytes_to_gray_image(byte_data, width, height):
    """ Convert byte data to a grayscale image of specified width and height. """
    byte_array = np.frombuffer(byte_data, dtype=np.uint8)
    return byte_array.reshape((width, height))


def process_python_file(file_path, output_dir):
    """ Process a Python file to create a grayscale image representation. """
    os.makedirs(output_dir, exist_ok=True)
    byte_data = read_bytes(file_path)
    gray_image = bytes_to_gray_image(byte_data, 32, 32)

    # Build the output image path
    output_path = os.path.join(output_dir, os.path.basename(file_path) + '.png')
    # Save the image
    cv2.imwrite(output_path, gray_image)


# Specify the Python file and output directory
python_file = '../03_Computer Vision/03_CNN.py'  # Change this to your path
output_dir = 'beneware/image_of_py'

process_python_file(python_file, output_dir)

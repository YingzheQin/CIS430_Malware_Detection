import csv


def extract_bytes_from_exe(file_path, num_bytes=1024):
    """Extract the first num_bytes from a PE file."""
    with open(file_path, 'rb') as f:
        return f.read(num_bytes)


def bytes_to_csv(data, output_csv):
    """Convert the extracted bytes to CSV format and save to a file."""
    with open(output_csv, 'w', newline='') as csvfile:
        writer = csv.writer(csvfile)
        writer.writerow(['Byte_' + str(i + 1) for i in range(len(data))])  # Header
        writer.writerow(data)


def main():
    input_exe = "../beneware/GoldenDictPortable_1.5_Rev_2.paf.exe"
    output_csv_path = "../beneware/extracted_data.csv"

    # Extract the first 1024 bytes from the PE file
    data = extract_bytes_from_exe(input_exe)

    # Convert the extracted bytes to CSV format
    bytes_to_csv(data, output_csv_path)


if __name__ == "__main__":
    main()
